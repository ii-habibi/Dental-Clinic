<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <title>Manage Blogs</title>
</head>
<body>
    <h1>Manage Blogs</h1>
    <a href="/dashboard/blogs/add">Add New Blog</a>
    <table>
        <thead>
            <tr>
                <th>Title</th>
                <th>Author</th>
                <th>Published Date</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <% blogs.forEach(blog => { %>
                <tr id="blog-<%= blog.blog_id %>">
                    <td><%= blog.title %></td>
                    <td><%= blog.author %></td>
                    <td><%= blog.published_date %></td>
                    <td>
                        <a href="/dashboard/blogs/edit/<%= blog.blog_id %>">Edit</a>
                        <button class="delete-button" data-id="<%= blog.blog_id %>">Delete</button>
                    </td>
                </tr>
            <% }) %>
        </tbody>
        
    </table>

    <script>
$(document).ready(function() {
    $('.delete-button').click(function() {
        const blogId = $(this).data('id'); // Get the blog ID from the button's data attribute
        const row = $('#blog-' + blogId); // Get the row to remove

        if (confirm('Are you sure you want to delete this blog?')) {
            $.ajax({
                url: '/dashboard/blogs/delete/' + blogId, // Specify the delete route
                type: 'POST', // Use the POST method as your route is handling POST, not DELETE
                success: function(response) {
                    row.fadeOut(300, function() {
                        $(this).remove(); // Remove the row from the table after fading out
                    });
                    alert('Blog deleted successfully!');
                },
                error: function(xhr) {
                    alert('An error occurred while deleting the blog. Please try again.');
                }
            });
        }
    });
});

    </script>
</body>
</html>
